{"ast":null,"code":"import \"antd-mobile/lib/wing-blank/style/css\";\nimport _WingBlank from \"antd-mobile/lib/wing-blank\";\nimport \"antd-mobile/lib/carousel/style/css\";\nimport _Carousel from \"antd-mobile/lib/carousel\";\nimport \"antd-mobile/lib/search-bar/style/css\";\nimport _SearchBar from \"antd-mobile/lib/search-bar\";\nimport \"antd-mobile/lib/grid/style/css\";\nimport _Grid from \"antd-mobile/lib/grid\";\nimport \"antd-mobile/lib/flex/style/css\";\nimport _Flex from \"antd-mobile/lib/flex\";\nvar _jsxFileName = \"F:\\\\\\u767E\\u5EA6\\u4E91\\u4E0B\\u8F7D\\\\React\\\\hkzf\\\\haokezufang\\\\src\\\\pages\\\\Index\\\\index.js\";\nimport React, { Component } from 'react';\nimport { BASE_URL } from '../../utils/axios';\nimport { getSwiper, getGroup, getNews } from '../../utils/api/home'; // import { getCityInfo } from '../../utils/api/city';\n\nimport navs from '../../utils/home_navs';\nimport './index.scss';\nimport { getCurrCity } from '../../utils';\n\nclass Index extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      swiper: [],\n      group: [],\n      news: [],\n      imgHeight: 234,\n      aplay: false,\n      keyword: '',\n      currCity: {\n        label: '--',\n        value: ''\n      }\n    };\n\n    this.loadDatas = async () => {\n      const apis = [getSwiper(), getGroup(this.state.currCity.value), getNews(this.state.currCity.value)];\n      let res = await Promise.all(apis);\n      console.log('all datas:', res);\n      this.setState({\n        swiper: res[0].data,\n        group: res[1].data,\n        news: res[2].data\n      }, () => {\n        this.setState({\n          aplay: true\n        });\n      });\n    };\n\n    this.renderNavs = () => {\n      return navs.map(item => React.createElement(_Flex.Item, {\n        onClick: () => this.props.history.push(item.path),\n        key: item.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: item.img,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, item.title)));\n    };\n\n    this.renderCarousel = () => {\n      console.log('d', this.state.swiper);\n      return this.state.swiper.map(val => React.createElement(\"a\", {\n        key: val.id,\n        href: \"http://www.itheima.com\",\n        style: {\n          display: 'inline-block',\n          width: '100%',\n          height: this.state.imgHeight,\n          background: 'gray'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: `${BASE_URL}${val.imgSrc}`,\n        alt: \"\",\n        style: {\n          width: '100%',\n          verticalAlign: 'top'\n        },\n        onLoad: () => {\n          // fire window resize event to change height\n          window.dispatchEvent(new Event('resize'));\n          this.setState({\n            imgHeight: 'auto'\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      })));\n    };\n\n    this.renderGroup = () => {\n      return React.createElement(React.Fragment, null, React.createElement(_Flex, {\n        className: \"group-title\",\n        justify: \"between\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"\\u79DF\\u623F\\u5C0F\\u7EC4\"), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"\\u66F4\\u591A\")), React.createElement(_Grid, {\n        data: this.state.group,\n        columnNum: 2,\n        square: false,\n        hasLine: false,\n        renderItem: item => {\n          return React.createElement(_Flex, {\n            className: \"grid-item\",\n            justify: \"between\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 119\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"desc\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          }, React.createElement(\"h3\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 121\n            },\n            __self: this\n          }, item.title), React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 122\n            },\n            __self: this\n          }, item.desc)), React.createElement(\"img\", {\n            src: `${BASE_URL}${item.imgSrc}`,\n            alt: \"\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 124\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }));\n    };\n\n    this.renderTopNav = () => {\n      const {\n        push\n      } = this.props.history;\n      return React.createElement(_Flex, {\n        justify: \"around\",\n        className: \"topNav\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"searchBox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"city\",\n        onClick: () => push('/cityList'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, this.state.currCity.label, React.createElement(\"i\", {\n        className: \"iconfont icon-arrow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      })), React.createElement(_SearchBar, {\n        value: this.state.keyword,\n        onChange: v => this.setState({\n          keyword: v\n        }),\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u5C0F\\u533A\\u6216\\u5730\\u5740\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"map\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        key: \"0\",\n        className: \"iconfont icon-map\",\n        onClick: () => push('/map'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      })));\n    };\n  }\n\n  componentDidMount() {\n    this.getCurrCity();\n  } // 获取当前城市信息\n\n\n  async getCurrCity() {\n    let data = await getCurrCity();\n    this.setState({\n      currCity: data\n    }, () => {\n      this.loadDatas();\n    });\n  } // getCurrCity = () => {\n  //   const myCity = new window.BMap.LocalCity();\n  //   myCity.get(async (result) => {\n  //     let res = await getCityInfo(result.name);\n  //     console.log(res);\n  //     res.status === 200 && this.setState({\n  //       currCity: res.data\n  //     }, () => {\n  //       this.loadDatas();\n  //     })\n  //   });\n  // }\n  // 获取初始化数据\n\n\n  // 渲染新闻列表\n  renderNews() {\n    return this.state.news.map(item => React.createElement(\"div\", {\n      className: \"news-item\",\n      key: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"imgwrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"img\",\n      src: `${BASE_URL}${item.imgSrc}`,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    })), React.createElement(_Flex, {\n      className: \"content\",\n      direction: \"column\",\n      justify: \"between\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      className: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, item.title), React.createElement(_Flex, {\n      className: \"info\",\n      justify: \"between\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, item.from), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, item.date)))));\n  } // 渲染顶部导航\n\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"indexBox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, this.renderTopNav(), React.createElement(_Carousel, {\n      autoplay: this.state.aplay,\n      infinite: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, this.renderCarousel()), React.createElement(_Flex, {\n      className: \"nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, this.renderNavs()), React.createElement(\"div\", {\n      className: \"group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, this.renderGroup()), React.createElement(\"div\", {\n      className: \"news\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      className: \"group-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, \"\\u6700\\u65B0\\u8D44\\u8BAF\"), React.createElement(_WingBlank, {\n      size: \"md\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, this.renderNews())));\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["F:/百度云下载/React/hkzf/haokezufang/src/pages/Index/index.js"],"names":["React","Component","BASE_URL","getSwiper","getGroup","getNews","navs","getCurrCity","Index","state","swiper","group","news","imgHeight","aplay","keyword","currCity","label","value","loadDatas","apis","res","Promise","all","console","log","setState","data","renderNavs","map","item","props","history","push","path","id","img","title","renderCarousel","val","display","width","height","background","imgSrc","verticalAlign","window","dispatchEvent","Event","renderGroup","desc","renderTopNav","v","componentDidMount","renderNews","from","date","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Carousel, Flex, Grid, WingBlank, SearchBar } from 'antd-mobile';\n\nimport { BASE_URL } from '../../utils/axios';\nimport { getSwiper, getGroup, getNews } from '../../utils/api/home';\n// import { getCityInfo } from '../../utils/api/city';\nimport navs from '../../utils/home_navs';\n\nimport './index.scss';\nimport { getCurrCity } from '../../utils';\n\n\nclass Index extends Component {\n  state = {\n    swiper: [],\n    group: [],\n    news: [],\n    imgHeight: 234,\n    aplay: false,\n    keyword: '',\n    currCity: {\n      label: '--',\n      value: ''\n    }\n  }\n  componentDidMount() {\n    this.getCurrCity()\n\n  }\n\n\n\n  // 获取当前城市信息\n  async getCurrCity() {\n    let data = await getCurrCity();\n    this.setState({\n      currCity: data\n    }, () => {\n      this.loadDatas();\n    })\n\n  }\n  // getCurrCity = () => {\n  //   const myCity = new window.BMap.LocalCity();\n  //   myCity.get(async (result) => {\n  //     let res = await getCityInfo(result.name);\n  //     console.log(res);\n  //     res.status === 200 && this.setState({\n  //       currCity: res.data\n  //     }, () => {\n  //       this.loadDatas();\n  //     })\n  //   });\n  // }\n\n  // 获取初始化数据\n  loadDatas = async () => {\n    const apis = [getSwiper(), getGroup(this.state.currCity.value), getNews(this.state.currCity.value)];\n    let res = await Promise.all(apis);\n    console.log('all datas:', res);\n    this.setState({\n      swiper: res[0].data,\n      group: res[1].data,\n      news: res[2].data\n    }, () => {\n      this.setState({\n        aplay: true\n      })\n    })\n  }\n\n  // 渲染菜单\n  renderNavs = () => {\n    return navs.map((item) => <Flex.Item onClick={() => this.props.history.push(item.path)} key={item.id}>\n      <img src={item.img} />\n      <p>{item.title}</p>\n    </Flex.Item>)\n  }\n\n  // 渲染轮播图\n  renderCarousel = () => {\n    console.log('d', this.state.swiper);\n    return this.state.swiper.map(val => (\n      <a\n        key={val.id}\n        href=\"http://www.itheima.com\"\n        style={{ display: 'inline-block', width: '100%', height: this.state.imgHeight, background: 'gray' }}\n      >\n        <img\n          src={`${BASE_URL}${val.imgSrc}`}\n          alt=\"\"\n          style={{ width: '100%', verticalAlign: 'top' }}\n          onLoad={() => {\n            // fire window resize event to change height\n            window.dispatchEvent(new Event('resize'));\n            this.setState({ imgHeight: 'auto' });\n          }}\n        />\n      </a>\n    ))\n  }\n\n  // 渲染租房小组\n  renderGroup = () => {\n    return (\n      <>\n        {/* 标题 */}\n        <Flex className=\"group-title\" justify=\"between\">\n          <h3>租房小组</h3>\n          <span>更多</span>\n        </Flex>\n        <Grid\n          data={this.state.group}\n          columnNum={2}\n          square={false}\n          hasLine={false}\n          renderItem={item => {\n            return (\n              <Flex className=\"grid-item\" justify=\"between\">\n                <div className=\"desc\">\n                  <h3>{item.title}</h3>\n                  <p>{item.desc}</p>\n                </div>\n                <img src={`${BASE_URL}${item.imgSrc}`} alt=\"\" />\n              </Flex>\n            )\n          }}\n        />\n      </>\n    )\n  }\n\n  // 渲染新闻列表\n  renderNews() {\n    return this.state.news.map(item => (\n      <div className=\"news-item\" key={item.id}>\n        <div className=\"imgwrap\">\n          <img\n            className=\"img\"\n            src={`${BASE_URL}${item.imgSrc}`}\n            alt=\"\"\n          />\n        </div>\n        <Flex className=\"content\" direction=\"column\" justify=\"between\">\n          <h3 className=\"title\">{item.title}</h3>\n          <Flex className=\"info\" justify=\"between\">\n            <span>{item.from}</span>\n            <span>{item.date}</span>\n          </Flex>\n        </Flex>\n      </div>\n    ))\n  }\n\n  // 渲染顶部导航\n  renderTopNav = () => {\n    const { push } = this.props.history;\n    return (\n      <Flex justify=\"around\" className=\"topNav\">\n        <div className=\"searchBox\">\n          <div className=\"city\" onClick={() => push('/cityList')}>\n            {this.state.currCity.label}<i className=\"iconfont icon-arrow\" />\n          </div>\n          <SearchBar\n            value={this.state.keyword}\n            onChange={(v) => this.setState({ keyword: v })}\n            placeholder=\"请输入小区或地址\"\n          />\n        </div>\n        <div className=\"map\">\n          <i key=\"0\" className=\"iconfont icon-map\" onClick={() => push('/map')} />\n        </div>\n      </Flex>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"indexBox\">\n        {/* 顶部导航 */}\n        {\n          this.renderTopNav()\n        }\n        {/* 轮播 */}\n        <Carousel\n          autoplay={this.state.aplay}\n          infinite\n        >\n          {this.renderCarousel()}\n        </Carousel>\n        {/* 菜单 */}\n        <Flex className=\"nav\">\n          {this.renderNavs()}\n        </Flex>\n        {/* 租房小组 */}\n        <div className=\"group\">\n          {this.renderGroup()}\n        </div>\n        {/* 最新资讯 */}\n        <div className=\"news\">\n          <h3 className=\"group-title\">最新资讯</h3>\n          <WingBlank size=\"md\">{this.renderNews()}</WingBlank>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}